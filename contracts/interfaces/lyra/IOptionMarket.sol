// SPDX-License-Identifier: ISC
pragma solidity 0.8.9;

import "./ILyraGlobals.sol";
import "./ILiquidityPool.sol";

interface IOptionMarket {
    struct OptionListing {
        uint id;
        uint strike;
        uint skew;
        uint longCall;
        uint shortCall;
        uint longPut;
        uint shortPut;
        uint boardId;
    }

    struct OptionBoard {
        uint id;
        uint expiry;
        uint iv;
        bool frozen;
        uint[] listingIds;
    }

    struct Trade {
        bool isBuy;
        uint amount;
        uint vol;
        uint expiry;
        ILiquidityPool.Liquidity liquidity;
    }

    enum TradeType {LONG_CALL, SHORT_CALL, LONG_PUT, SHORT_PUT}

    enum Error {
        TransferOwnerToZero,
        InvalidBoardId,
        InvalidBoardIdOrNotFrozen,
        InvalidListingIdOrNotFrozen,
        StrikeSkewLengthMismatch,
        BoardMaxExpiryReached,
        CannotStartNewRoundWhenBoardsExist,
        ZeroAmountOrInvalidTradeType,
        BoardFrozenOrTradingCutoffReached,
        QuoteTransferFailed,
        BaseTransferFailed,
        BoardNotExpired,
        BoardAlreadyLiquidated,
        OnlyOwner,
        Last
    }

    function maxExpiryTimestamp() external view returns (uint);

    function optionBoards(uint)
        external
        view
        returns (
        uint id,
        uint expiry,
        uint iv,
        bool frozen
        );

    function optionListings(uint)
        external
        view
        returns (
        uint id,
        uint strike,
        uint skew,
        uint longCall,
        uint shortCall,
        uint longPut,
        uint shortPut,
        uint boardId
        );

    function boardToPriceAtExpiry(uint) external view returns (uint);

    function listingToBaseReturnedRatio(uint) external view returns (uint);

    function transferOwnership(address newOwner) external;

    function setBoardFrozen(uint boardId, bool frozen) external;

    function setBoardBaseIv(uint boardId, uint baseIv) external;

    function setListingSkew(uint listingId, uint skew) external;

    function createOptionBoard(
        uint expiry,
        uint baseIV,
        uint[] memory strikes,
        uint[] memory skews
    ) external returns (uint);

    function addListingToBoard(
        uint boardId,
        uint strike,
        uint skew
    ) external;

    function getLiveBoards() external view returns (uint[] memory _liveBoards);

    function getBoardListings(uint boardId) external view returns (uint[] memory);

    function openPosition(
        uint _listingId,
        TradeType tradeType,
        uint amount
    ) external returns (uint totalCost);

    function closePosition(
        uint _listingId,
        TradeType tradeType,
        uint amount
    ) external returns (uint totalCost);

    function liquidateExpiredBoard(uint boardId) external;

    function settleOptions(uint listingId, TradeType tradeType) external;
}
